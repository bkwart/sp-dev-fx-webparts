{"version":3,"sources":["webparts/trendingInThisSite/components/TrendingInThisSite.tsx"],"names":[],"mappings":"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","file":"webparts/trendingInThisSite/components/TrendingInThisSite.js","sourcesContent":["import * as React from 'react';\nimport {\n  DocumentCard,\n  DocumentCardPreview,\n  DocumentCardTitle,\n  DocumentCardActivity,\n  Spinner\n} from 'office-ui-fabric-react';\n\nimport styles from '../TrendingInThisSite.module.scss';\nimport { ITrendingInThisSiteWebPartProps } from '../ITrendingInThisSiteWebPartProps';\n\nexport interface ITrendingInThisSiteProps extends ITrendingInThisSiteWebPartProps {\n  siteUrl: string;\n}\n\nexport interface ITrendingInThisSiteState {\n  trendingDocuments: ITrendingDocument[];\n  loading: boolean;\n  error: string;\n}\n\nexport interface ITrendingDocument {\n  id: string;\n  title: string;\n  url: string;\n  previewImageUrl: string;\n  lastModifiedByPhotoUrl: string;\n  lastModifiedByName: string;\n  lastModifiedTime: string;\n  extension: string;\n}\n\ninterface ISearchResultValue {\n  Key: string;\n  Value: string;\n}\n\nexport default class TrendingInThisSite extends React.Component<ITrendingInThisSiteProps, ITrendingInThisSiteState> {\n  constructor(props: ITrendingInThisSiteProps, state: ITrendingInThisSiteState) {\n    super(props);\n\n    this.state = {\n      trendingDocuments: [] as ITrendingDocument[],\n      loading: true,\n      error: null\n    };\n  }\n\n  public componentDidMount(): void {\n    this.loadTrendingContent(this.props.siteUrl, this.props.numberOfDocuments);\n  }\n\n  public componentDidUpdate(prevProps: ITrendingInThisSiteProps, prevState: ITrendingInThisSiteState, prevContext: any): void {\n    if (this.props.numberOfDocuments !== prevProps.numberOfDocuments ||\n      this.props.siteUrl !== prevProps.siteUrl && (\n        this.props.numberOfDocuments && this.props.siteUrl\n      )) {\n      this.loadTrendingContent(this.props.siteUrl, this.props.numberOfDocuments);\n    }\n  }\n\n  public render(): JSX.Element {\n    const loading: JSX.Element = this.state.loading ? <div style={{margin: '0 auto'}}><Spinner label={'Loading...'} /></div> : <div/>;\n    const error: JSX.Element = this.state.error ? <div><strong>Error:</strong> {this.state.error}</div> : <div/>;\n    const documents: JSX.Element[] = this.state.trendingDocuments.map((doc: ITrendingDocument, i: number) => {\n      const iconUrl: string = `https://spoprod-a.akamaihd.net/files/odsp-next-prod_ship-2016-08-15_20160815.002/odsp-media/images/filetypes/32/${doc.extension}.png`;\n      return (\n        <DocumentCard onClickHref={doc.url} key={doc.id}>\n          <DocumentCardPreview\n            previewImages={[\n              {\n                previewImageSrc: doc.previewImageUrl,\n                iconSrc: iconUrl,\n                width: 318,\n                height: 196,\n                accentColor: '#ce4b1f'\n              }\n            ]}\n            />\n          <DocumentCardTitle title={doc.title}/>\n          <DocumentCardActivity\n            activity={'Modified ' + doc.lastModifiedTime}\n            people={\n              [\n                { name: doc.lastModifiedByName, profileImageSrc: doc.lastModifiedByPhotoUrl }\n              ]\n            }\n            />\n        </DocumentCard>\n      );\n    });\n    return (\n      <div className={styles.trendingInThisSite}>\n        {loading}\n        {error}\n        {documents}\n        <div style={{clear: 'both'}}/>\n      </div>\n    );\n  }\n\n  private getValueFromResults(key: string, results: ISearchResultValue[]): string {\n    let value: string = '';\n\n    if (results != null && results.length > 0 && key != null) {\n      for (let i: number = 0; i < results.length; i++) {\n        const resultItem: ISearchResultValue = results[i];\n        if (resultItem.Key === key) {\n          value = resultItem.Value;\n          break;\n        }\n      }\n    }\n\n    return value;\n  }\n\n  private trim(s: string): string {\n    if (s != null && s.length > 0) {\n      return s.replace(/^\\s+|\\s+$/gm, '');\n    }\n    else {\n      return s;\n    }\n  }\n\n  private getPreviewImageUrl(result: ISearchResultValue[], siteUrl: string): string {\n    const uniqueID: string = this.getValueFromResults('uniqueID', result);\n    const siteId: string = this.getValueFromResults('siteID', result);\n    const webId: string = this.getValueFromResults('webID', result);\n    const docId: string = this.getValueFromResults('DocId', result);\n    if (uniqueID !== null && siteId !== null && webId !== null && docId !== null) {\n      return `${siteUrl}/_layouts/15/getpreview.ashx?guidFile=${uniqueID}&guidSite=${siteId}&guidWeb=${webId}&docid=${docId}\n      &metadatatoken=300x424x2&ClientType=CodenameOsloWeb&size=small`;\n    }\n    else {\n      return '';\n    }\n  }\n\n  private getUserPhotoUrl(userEmail: string, siteUrl: string): string {\n    return `${siteUrl}/_layouts/15/userphoto.aspx?size=S&accountname=${userEmail}`;\n  }\n\n  private request<T>(url: string, method: string = 'GET', headers: any = null, data: any = null): Promise<T> {\n    return new Promise<T>((resolve, reject): void => {\n      const xhr: XMLHttpRequest = new XMLHttpRequest();\n      xhr.onreadystatechange = function (): void {\n        if (this.readyState === 4) {\n          if (this.status === 200) {\n            resolve(this.response as T);\n          }\n          else if (this.status >= 400) {\n            reject({\n              message: this.response['odata.error'].message.value,\n              statusText: this.statusText,\n              status: this.status\n            });\n          }\n        }\n      };\n\n      xhr.open(method, url, true);\n      if (headers === null) {\n        xhr.setRequestHeader('Accept', 'application/json;odata=nometadata');\n      }\n      else {\n        for (var header in headers) {\n          if (headers.hasOwnProperty(header)) {\n            xhr.setRequestHeader(header, headers[header]);\n          }\n        }\n      }\n      xhr.responseType = 'json';\n      xhr.send(data);\n    });\n  }\n\n  private getSiteMembers(siteUrl: string): Promise<string[]> {\n    const component: TrendingInThisSite = this;\n    return new Promise<string[]>((resolve: (siteMembers: string[]) => void, reject: (err: any) => void): void => {\n      component.request(`${siteUrl}/_api/Web/AssociatedMemberGroup/Users?$select=Email`).then((members: { value: { Email: string }[] }): void => {\n        const siteMembers: string[] = [];\n        for (let i: number = 0; i < members.value.length; i++) {\n          siteMembers.push(members.value[i].Email);\n        }\n\n        resolve(siteMembers);\n      }, (error: any): void => {\n        reject(error);\n      });\n    });\n  }\n\n  private getActors(siteMembers: string[], requestDigest: string, siteUrl: string): Promise<string[]> {\n    const component: TrendingInThisSite = this;\n    let query: string = '';\n    siteMembers.forEach((member: string): void => {\n      if (query.length > 0) {\n        query += ' OR ';\n      }\n      query += `UserName:${member}`;\n    });\n    const postData: string = JSON.stringify({\n      'request': {\n        '__metadata': {\n          'type': 'Microsoft.Office.Server.Search.REST.SearchRequest'\n        },\n        'Querytext': query,\n        'SelectProperties': {\n          'results': ['DocId', 'WorkEmail']\n        },\n        'RowLimit': '100',\n        'StartRow': '0',\n        'SourceId': 'b09a7990-05ea-4af9-81ef-edfab16c4e31'\n      }\n    });\n\n    return new Promise<string[]>((resolve: (actors: string[]) => void, reject: (err?: any) => void): void => {\n      component.request(`${siteUrl}/_api/search/postquery`, 'POST', {\n        'Accept': 'application/json;odata=nometadata',\n        'Content-Type': 'application/json;odata=verbose',\n        'X-RequestDigest': requestDigest\n      }, postData).then((data: any): void => {\n        if (data && data.PrimaryQueryResult && data.PrimaryQueryResult.RelevantResults) {\n          const actors: string[] = [];\n          data.PrimaryQueryResult.RelevantResults.Table.Rows.forEach((row: any): void => {\n            const actorId: string = component.getValueFromResults('DocId', row.Cells);\n            if (actorId != null && actorId.length > 0) {\n              actors.push(actorId);\n            }\n          });\n          resolve(actors);\n        }\n        else {\n          reject();\n        }\n      }, (error: any): void => {\n        reject(error);\n      });\n    });\n  }\n\n  private getTrendingContent(siteUrl: string, actors: string[], requestDigest: string): Promise<ITrendingDocument[]> {\n    const component: TrendingInThisSite = this;\n    let gq: string = '';\n    if (actors.length > 1) {\n      actors.forEach((actor: string): void => {\n        if (gq.length > 0) {\n          gq += ',';\n        }\n        gq += `actor(${actor},action:1020)`;\n      });\n      gq += ',and(actor(me,action:1021),actor(me,or(action:1021,action:1036,action:1037,action:1039)))';\n      gq = `or(${gq})`;\n    }\n    else {\n      gq = `or(actor(${actors[0]},action:1020),and(actor(me,action:1021),actor(me,or(action:1021,action:1036,action:1037,action:1039))))`;\n    }\n    siteUrl = siteUrl.replace(':443/', '/');\n    const postData: string = JSON.stringify({\n      'request': {\n        '__metadata': {\n          'type': 'Microsoft.Office.Server.Search.REST.SearchRequest'\n        },\n        'Querytext': 'path:' + siteUrl,\n        'SelectProperties': {\n          'results': ['Author', 'AuthorOwsUser', 'DocId', 'DocumentPreviewMetadata', 'Edges', 'EditorOwsUser', 'FileExtension', 'FileType', 'HitHighlightedProperties', 'HitHighlightedSummary', 'LastModifiedTime', 'LikeCountLifetime', 'ListID', 'ListItemID', 'OriginalPath', 'Path', 'Rank', 'SPWebUrl', 'SecondaryFileExtension', 'ServerRedirectedURL', 'SiteTitle', 'Title', 'ViewCountLifetime', 'siteID', 'uniqueID', 'webID']\n        },\n        'ClientType': 'TrendingInThisSite',\n        'BypassResultTypes': 'true',\n        'RowLimit': component.props.numberOfDocuments.toString(),\n        'StartRow': '0',\n        'RankingModelId': '0c77ded8-c3ef-466d-929d-905670ea1d72',\n        'Properties': {\n          'results': [{\n            'Name': 'IncludeExternalContent',\n            'Value': {\n              'BoolVal': 'True',\n              'QueryPropertyValueTypeIndex': 3\n            }\n          }, {\n              'Name': 'GraphQuery',\n              'Value': {\n                'StrVal': gq,\n                'QueryPropertyValueTypeIndex': 1\n              }\n            }, {\n              'Name': 'GraphRankingModel',\n              'Value': {\n                'StrVal': '{\"features\":[{\"function\":\"EdgeWeight\"}],\"featureCombination\":\"sum\",\"actorCombination\":\"sum\"}',\n                'QueryPropertyValueTypeIndex': 1\n              }\n            }]\n        }\n      }\n    });\n    return new Promise<ITrendingDocument[]>((resolve: (trendingDocuments: ITrendingDocument[]) => void, reject: (err: any) => void): void => {\n      component.request(`${siteUrl}/_api/search/postquery`, 'POST', {\n        'Accept': 'application/json;odata=nometadata',\n        'Content-Type': 'application/json;odata=verbose',\n        'X-RequestDigest': requestDigest\n      }, postData).then((data: any): void => {\n        const trendingContent: ITrendingDocument[] = [];\n        if (data.PrimaryQueryResult && data.PrimaryQueryResult.RelevantResults &&\n          data.PrimaryQueryResult.RelevantResults.Table.Rows.length > 0) {\n          data.PrimaryQueryResult.RelevantResults.Table.Rows.forEach((row: any): void => {\n            const cells: ISearchResultValue[] = row.Cells;\n            const editorInfo: string[] = component.getValueFromResults('EditorOwsUser', cells).split('|');\n            const modifiedDate: Date = new Date(component.getValueFromResults('LastModifiedTime', cells).replace('.0000000', ''));\n            const dateString: string = (modifiedDate.getMonth() + 1) + '/' + modifiedDate.getDate() + '/' + modifiedDate.getFullYear();\n            trendingContent.push({\n              id: component.getValueFromResults('DocId', cells),\n              url: component.getValueFromResults('ServerRedirectedURL', cells),\n              title: component.getValueFromResults('Title', cells),\n              previewImageUrl: component.getPreviewImageUrl(cells, siteUrl),\n              lastModifiedTime: dateString,\n              lastModifiedByName: component.trim(editorInfo[1]),\n              lastModifiedByPhotoUrl: component.getUserPhotoUrl(component.trim(editorInfo[0]), siteUrl),\n              extension: component.getValueFromResults('FileType', cells)\n            });\n          });\n        }\n        resolve(trendingContent);\n      }, (error: any): void => {\n        reject(error);\n      });\n    });\n  }\n\n  private loadTrendingContent(siteUrl: string, numberOfDocuments: number): void {\n    const component: TrendingInThisSite = this;\n\n    let requestDigest: string = null;\n    component.getRequestDigest(siteUrl)\n      .then((digest: string): void => {\n        requestDigest = digest;\n      }, (err: any): void => {\n        component.handleError(err);\n      })\n      .then((): Promise<string[]> => {\n        return component.getSiteMembers(siteUrl);\n      }, (err: any): void => {\n        component.handleError(err);\n      })\n      .then((siteMembers: string[]): Promise<string[]> => {\n        return component.getActors(siteMembers, requestDigest, siteUrl);\n      }, (err: any): void => {\n        component.handleError(err);\n      })\n      .then((actors: string[]): Promise<ITrendingDocument[]> => {\n        return component.getTrendingContent(siteUrl, actors, requestDigest);\n      }, (err: any): void => {\n        component.handleError(err);\n      })\n      .then((trendingDocuments: ITrendingDocument[]): void => {\n        component.setState((previousState: ITrendingInThisSiteState, curProps: ITrendingInThisSiteProps): ITrendingInThisSiteState => {\n          previousState.trendingDocuments.length = 0;\n          return previousState;\n        });\n        trendingDocuments.forEach((result): void => {\n          component.setState((previousState: ITrendingInThisSiteState, curProps: ITrendingInThisSiteProps): ITrendingInThisSiteState => {\n            previousState.trendingDocuments.push(result);\n            return previousState;\n          });\n        });\n        component.setState((previousState: ITrendingInThisSiteState, curProps: ITrendingInThisSiteProps): ITrendingInThisSiteState => {\n          previousState.loading = false;\n          return previousState;\n        });\n      }, (err: any): void => {\n        component.handleError(err);\n      });\n  }\n\n  private handleError(err: any): void {\n    if (err.responseJSON && err.responseJSON.error) {\n      this.setState((previousState: ITrendingInThisSiteState, curProps: ITrendingInThisSiteProps): ITrendingInThisSiteState => {\n        previousState.error = \"The following error has occured while running the query: \" + err.responseJSON.error.message.value;\n        return previousState;\n      });\n    } else if (err.responseJSON && err.responseJSON[\"odata.error\"]) {\n      this.setState((previousState: ITrendingInThisSiteState, curProps: ITrendingInThisSiteProps): ITrendingInThisSiteState => {\n        previousState.error = \"The following error has occured while running the query: \" + err.responseJSON[\"odata.error\"].message.value;\n        return previousState;\n      });\n    } else {\n      this.setState((previousState: ITrendingInThisSiteState, curProps: ITrendingInThisSiteProps): ITrendingInThisSiteState => {\n        previousState.error = \"An unexpected error occured while running the query\";\n        return previousState;\n      });\n    }\n\n    this.setState((previousState: ITrendingInThisSiteState, curProps: ITrendingInThisSiteProps): ITrendingInThisSiteState => {\n      previousState.loading = false;\n      return previousState;\n    });\n  }\n\n  private getRequestDigest(siteUrl: string): Promise<string> {\n    const component: TrendingInThisSite = this;\n    return new Promise<string>((resolve, reject): void => {\n      component.request(`${siteUrl}/_api/contextinfo`, 'POST').then((data: { FormDigestValue: string }): void => {\n        resolve(data.FormDigestValue);\n      }, (error: any): void => {\n        reject(error);\n      });\n    });\n  }\n}\n"],"sourceRoot":"..\\..\\..\\..\\src"}